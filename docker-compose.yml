version: '2'
services:
    app:
        image: node:6.10.3
        working_dir: /usr/src/app
        ports:
            - "9555:9555"
        volumes:
            - ./app:/usr/src/app
            - ~/.node_cache/geotrellis-collections-api-research-node-modules:/usr/src/app/node_modules
        command:
            yarn run start
    api:
        build:
            context: ./api
            dockerfile: Dockerfile
        volumes:
            - ./api/geotrellis_collections_api:/usr/src
            - ./data:/usr/data
        ports:
            - "7000:7000"
        command:
            ./sbt "~;jetty:stop;jetty:start"
